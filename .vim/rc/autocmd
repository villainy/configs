" Set appropriate filetypes
autocmd BufEnter *.erb,*.rhtml setf eruby
autocmd BufEnter *.pl compiler perl
autocmd BufEnter *.mako setf mako
autocmd BufEnter *.cib setf pcmk
autocmd BufEnter *.tdl setf xml
autocmd BufEnter *.nse setf lua
autocmd BufEnter *.cron setf crontab
autocmd BufNewFile,BufRead *Test.php setf filetype=php.phpunit | UltiSnipsAddFiletypes php-phpunit.php<CR>
autocmd BufNewFile,BufRead *.md setf filetype=markdown

" Indent with spaces instead of tabs in python
autocmd FileType python setl et

" Set column 80 marker for source files
autocmd FileType php,python,java,pl,javascript,c,cpp setl colorcolumn=80

" Strip trailing whitespace from code files on save
"autocmd FileType php,python,java,pl,javascript,c,cpp autocmd BufWritePre <buffer> :%s/\s\+$//e"

" run file with PHP CLI (CTRL-L)
autocmd BufEnter php nmap <C-L> :Shell /usr/bin/php %<CR>

autocmd FileType python
    \ setlocal tabstop=4
    \ softtabstop=4
    \ shiftwidth=4
    \ textwidth=80
    \ smarttab
    \ expandtab

" Override omnifunc autocompletion for java
au BufNewFile,BufRead *.java    setl omnifunc=javaapi#complete
au CompleteDone *.java          call javaapi#showRef()
au BufNewFile,BufRead *.java    inoremap <expr> <c-down> javaapi#nextRef()
au BufNewFile,BufRead *.java    inoremap <expr> <c-up>   javaapi#prevRef()

if has("balloon_eval") && has("balloon_multiline") 
	au BufNewFile,BufRead *.java  setl bexpr=javaapi#balloon()
	au BufNewFile,BufRead *.java  setl ballooneval
endif

" Open golang tag definition in vertical split
au Filetype go nnoremap <C-W>[ :vsp <CR>:exe "GoDef" <CR>

" Auto-close preview window after autocomplete
"autocmd CompleteDone * pclose
autocmd InsertLeave * if pumvisible() == 0|pclose|endif

" JS autocompletion
"autocmd FileType javascript setlocal omnifunc=tern#Complete
"autocmd FileType javascript setlocal omnifunc=javascriptcomplete#CompleteJS
autocmd FileType javascript setlocal omnifunc=tern#Complete

" vim: ft=vim
